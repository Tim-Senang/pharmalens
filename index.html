<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pharmalens</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      html {
        scroll-behavior: smooth;
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-800">
    <!-- Navbar -->
    <nav class="bg-white shadow-md py-4 sticky top-0 z-50">
      <div class="container mx-auto px-4 flex justify-between items-center">
        <h1 class="text-2xl font-bold text-green-600">Pharmalens</h1>
        <ul class="hidden md:flex items-center space-x-6">
          <li><a href="#" class="hover:text-green-600">Home</a></li>
          <li><a href="#about" class="hover:text-green-600">About</a></li>
          <li><a href="#services" class="hover:text-green-600">Services</a></li>
          <li><a href="#history" class="hover:text-green-600">Riwayat</a></li>
          <li><a href="#scan" class="hover:text-green-600">Scan</a></li>
          <li>
            <button
              class="border border-green-600 text-green-600 px-4 py-2 rounded hover:bg-green-600 hover:text-white transition"
            >
              Login
            </button>
          </li>
        </ul>
        <!-- Hamburger button -->
        <button class="md:hidden text-3xl relative z-50" onclick="toggleMenu()">
          â˜°
        </button>
      </div>
    </nav>

    <!-- Mobile Slide-in Menu -->
    <div
      id="mobile-menu"
      class="fixed top-14 right-0 h-full w-64 bg-white shadow-lg transform translate-x-full transition-transform duration-300 ease-in-out z-40 p-6 space-y-4 md:hidden"
    >
      <button class="text-2xl absolute top-4 right-4" onclick="toggleMenu()">
        âœ•
      </button>
      <a href="#" class="block border-b pb-2 text-gray-700">Home</a>
      <a href="#about" class="block border-b pb-2 text-gray-700">About</a>
      <a href="#services" class="block border-b pb-2 text-gray-700">Services</a>
      <a href="#history" class="block border-b pb-2 text-gray-700">Riwayat</a>
      <a href="#scan" class="block border-b pb-2 text-gray-700">Scan</a>
      <a href="#" class="block text-gray-700">Login</a>
    </div>

    <!-- Optional overlay -->
    <div
      id="overlay"
      class="fixed inset-0 bg-black bg-opacity-50 hidden z-30 md:hidden"
      onclick="toggleMenu()"
    ></div>

    <!-- Hero -->
    <section class="bg-gradient-to-r from-green-100 to-green-50 py-20 mx-auto">
      <div
        class="container max-w-6xl mx-auto px-4 flex flex-col-reverse md:flex-row items-center justify-center text-center md:text-left gap-10"
      >
        <!-- Teks Hero -->
        <div class="md:w-1/2 md:pl-6">
          <h2
            class="text-4xl md:text-5xl font-bold text-gray-800 leading-tight"
          >
            Empowering Lives Through Health
          </h2>
          <p class="mt-4 text-gray-600">
            Scan obat dengan mudah dan dapatkan informasi tentang indikasi dan
            efek sampingnya.
          </p>
          <a
            href="#scan"
            class="inline-block mt-6 bg-green-600 text-white font-semibold px-6 py-3 rounded hover:bg-green-700"
          >
            Mulai Scan
          </a>
        </div>

        <!-- Gambar Hero -->
        <div class="md:w-1/2">
          <img
            src="./img/medicine.png"
            alt="Hero Image"
            class="max-w-[400px] w-full mx-auto"
          />
        </div>
      </div>
    </section>

    <!-- About -->
    <section id="about" class="py-16 bg-white">
      <div class="container mx-auto px-4 text-center">
        <h3 class="text-3xl font-bold text-gray-800 mb-6">
          Tentang Pharmalens
        </h3>
        <p class="text-gray-600 max-w-3xl mx-auto">
          Pharmalens adalah platform berbasis AI yang membantu Anda memahami
          obat-obatan dengan lebih mudah. Cukup dengan memindai kemasan obat,
          Anda akan mendapatkan informasi mengenai indikasi dan efek sampingnya
          secara instan.
        </p>
      </div>
    </section>

    <!-- Services -->
    <section id="services" class="py-16 bg-gray-100">
      <div class="container mx-auto px-4 text-center">
        <h3 class="text-3xl font-bold text-gray-800 mb-10">Fitur Kami</h3>
        <div class="grid md:grid-cols-3 gap-8">
          <div
            class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition"
          >
            <h4 class="text-xl font-semibold text-green-600 mb-2">Scan Obat</h4>
            <p class="text-gray-600">
              Pindai label obat menggunakan kamera dan dapatkan data lengkapnya.
            </p>
          </div>
          <div
            class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition"
          >
            <h4 class="text-xl font-semibold text-green-600 mb-2">
              Informasi Efek Samping
            </h4>
            <p class="text-gray-600">
              Ketahui efek samping dari obat-obatan yang Anda konsumsi.
            </p>
          </div>
          <div
            class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition"
          >
            <h4 class="text-xl font-semibold text-green-600 mb-2">
              Riwayat Scan
            </h4>
            <p class="text-gray-600">
              Semua hasil scan Anda akan tersimpan secara otomatis.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- History -->
    <section id="history" class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <h3 class="text-3xl font-bold text-gray-800 text-center mb-10">
          Riwayat Scan
        </h3>
        <p class="text-center text-gray-600">Belum ada riwayat scan.</p>
      </div>
    </section>

    <!-- Scan Form -->
    <!-- Scan Form -->
    <section id="scan" class="py-16 bg-white">
      <div class="container mx-auto px-4 max-w-2xl">
        <h3 class="text-3xl font-bold text-center mb-2 text-green-600">
          Mulai Scan Obat
        </h3>
        <p class="text-center text-gray-500 mb-6">
          Unggah foto kemasan obat dan dapatkan informasinya secara instan
        </p>
        <form id="scan-form" class="bg-gradient-to-r from-white to-green-50 p-8 rounded-xl shadow-lg space-y-6 border">
  <div class="mb-4">
    <label class="block mb-2 font-medium text-gray-700">Nama Obat (Manual)</label>
    <input id="nama-obat" type="text" class="w-full border border-gray-300 rounded px-3 py-2" placeholder="Masukkan nama obat atau scan gambar" />
  </div>
  <div class="mb-4">
    <label class="block mb-2 font-medium text-gray-700">Upload Foto Obat</label>
    <input id="file-obat" type="file" class="w-full border border-gray-300 rounded px-3 py-2 file:mr-4 file:py-2 file:px-4 file:border-0 file:rounded file:bg-green-600 file:text-white hover:file:bg-green-700" accept="image/*" />
    <div id="preview-container" class="mt-2 hidden">
      <img id="preview-image" src="#" alt="Preview Obat" class="max-h-40 mx-auto rounded shadow border" />
    </div>
  </div>
  <div class="mb-4 flex gap-2">
    <button id="proses-btn" type="button" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Proses</button>
    <button type="reset" class="bg-gray-300 text-gray-800 px-4 py-2 rounded hover:bg-gray-400">Reset</button>
  </div>
  <div>
    <label class="block mb-2 font-medium text-gray-700">Hasil</label>
    <textarea id="hasil-scan" class="w-full border rounded px-3 py-2 h-32 bg-gray-50" placeholder="Hasil scan atau manfaat obat akan muncul di sini..." readonly></textarea>
  </div>
  <div class="flex justify-end">
    <button id="simpan-riwayat-btn" type="button" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Simpan Riwayat</button>
  </div>
</form>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-green-900 text-white pt-12 pb-6 mt-16">
      <div
        class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-11"
      >
        <!-- Brand -->
        <div>
          <h4 class="text-2xl font-bold text-white mb-4">Pharmalens</h4>
          <p class="text-sm text-white leading-relaxed">
            Pharmalens memudahkan pemahaman obat dengan teknologi scan berbasis
            AI.
          </p>
        </div>

        <!-- Navigation -->
        <div>
          <h4 class="text-lg font-semibold mb-4 text-white">Navigasi</h4>
          <ul class="space-y-2 text-white text-sm">
            <li><a href="#home" class="hover:text-white">Beranda</a></li>
            <li><a href="#about" class="hover:text-white">Tentang</a></li>
            <li><a href="#services" class="hover:text-white">Fitur</a></li>
            <li><a href="#history" class="hover:text-white">Riwayat</a></li>
            <li><a href="#scan" class="hover:text-white">Scan</a></li>
          </ul>
        </div>

        <!-- Contact -->
        <div>
          <h4 class="text-lg font-semibold mb-4 text-white">Kontak Kami</h4>
          <p class="text-sm text-gray-400">ðŸ“§ info@pharmalens.com</p>
          <p class="text-sm text-gray-400">ðŸ“ž +62 812 3456 7890</p>
        </div>
      </div>
      <div
        class="text-center text-sm text-white mt-10 border-t border-white pt-6"
      >
        &copy; 2025 Pharmalens. All rights reserved.
      </div>
    </footer>

    <!-- Script Integrasi Scan & Manfaat Obat -->
    <script>
      const prosesBtn = document.getElementById('proses-btn');
      const simpanBtn = document.getElementById('simpan-riwayat-btn');
      const hasilScan = document.getElementById('hasil-scan');
      const namaObatInput = document.getElementById('nama-obat');
      const fileObatInput = document.getElementById('file-obat');

      let lastNamaObat = '';
      let lastManfaat = '';

      prosesBtn.addEventListener('click', async () => {
        hasilScan.value = 'Memproses...';
        let namaObat = namaObatInput.value.trim();
        let manfaat = '';
        if (namaObat) {
          // Manual input, fetch manfaat dari backend
          try {
            const res = await fetch('http://127.0.0.1:5000/manfaat', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ nama_obat: namaObat })
            });
            const data = await res.json();
            if (data.manfaat) {
              hasilScan.value = data.manfaat;
              lastNamaObat = namaObat;
              lastManfaat = data.manfaat;
            } else {
              hasilScan.value = data.error || 'Gagal mendapatkan manfaat.';
            }
          } catch (e) {
            hasilScan.value = 'Terjadi kesalahan.';
          }
        } else if (fileObatInput.files.length > 0) {
          // Scan gambar, fetch nama obat dari backend
          const formData = new FormData();
          formData.append('file', fileObatInput.files[0]);
          try {
            const res = await fetch('http://127.0.0.1:5000/scan', {
              method: 'POST',
              body: formData
            });
            const data = await res.json();
            if (data.text) {
              // Ambil nama obat dari hasil OCR
              namaObat = data.text.split('\n')[0].trim(); // Ambil baris pertama
              namaObatInput.value = namaObat;
              // Fetch manfaat obat
              const res2 = await fetch('http://127.0.0.1:5000/manfaat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ nama_obat: namaObat })
              });
              const data2 = await res2.json();
              if (data2.manfaat) {
                hasilScan.value = data2.manfaat;
                lastNamaObat = namaObat;
                lastManfaat = data2.manfaat;
              } else {
                hasilScan.value = data2.error || 'Gagal mendapatkan manfaat.';
              }
            } else {
              hasilScan.value = data.error || 'Gagal scan gambar.';
            }
          } catch (e) {
            hasilScan.value = 'Terjadi kesalahan saat scan.';
          }
        } else {
          hasilScan.value = 'Isi nama obat atau upload gambar.';
        }
      });

      simpanBtn.addEventListener('click', async () => {
        if (!lastNamaObat || !lastManfaat) {
          alert('Proses dulu nama obat atau scan gambar sebelum simpan riwayat.');
          return;
        }
        try {
          const res = await fetch('http://127.0.0.1:5000/riwayat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nama_obat: lastNamaObat, manfaat: lastManfaat })
          });
          const data = await res.json();
          if (data.status === 'ok') {
            alert('Riwayat berhasil disimpan!');
          } else {
            alert('Gagal simpan riwayat.');
          }
        } catch (e) {
          alert('Terjadi kesalahan saat simpan riwayat.');
        }
      });
    </script>

    <!-- Script -->
    <script>
      function toggleMenu() {
        const menu = document.getElementById("mobile-menu");
        const overlay = document.getElementById("overlay");
        const isOpen = menu.classList.contains("translate-x-0");

        if (isOpen) {
          menu.classList.add("translate-x-full");
          menu.classList.remove("translate-x-0");
          overlay.classList.add("hidden");
          document.body.classList.remove("overflow-hidden");
        } else {
          menu.classList.remove("translate-x-full");
          menu.classList.add("translate-x-0");
          overlay.classList.remove("hidden");
          document.body.classList.add("overflow-hidden");
        }
      }
    </script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const fileObatInput = document.getElementById('file-obat');
    const previewContainer = document.getElementById('preview-container');
    const previewImage = document.getElementById('preview-image');
  
    fileObatInput.addEventListener('change', function() {
      if (this.files && this.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          previewImage.src = e.target.result;
          previewContainer.classList.remove('hidden');
        };
        reader.readAsDataURL(this.files[0]);
      } else {
        previewContainer.classList.add('hidden');
        previewImage.src = '#';
      }
    });
  
    document.getElementById('scan-form').addEventListener('reset', function() {
      previewContainer.classList.add('hidden');
      previewImage.src = '#';
    });
  });
  </script>
    </body>
</html>
